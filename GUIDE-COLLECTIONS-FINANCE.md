# üìã GUIDE : CR√âER LES COLLECTIONS FINANCE - APPWRITE

**Date** : 13 octobre 2025  
**Objectif** : Cr√©er 5 collections pour le module Finance avanc√©  
**Dur√©e estim√©e** : 15-20 minutes

---

## üéØ COLLECTIONS √Ä CR√âER

1. ‚úÖ `demo_budgets` - Budgets de projets/bureaux
2. ‚úÖ `demo_budget_lines` - Lignes de budget
3. ‚úÖ `demo_budget_items` - Items de budget d√©taill√©s
4. ‚úÖ `demo_recurring_invoices` - Factures r√©currentes
5. ‚úÖ `demo_recurring_expenses` - D√©penses r√©currentes

---

## üöÄ ACC√àS √Ä APPWRITE CONSOLE

### √âtape 1 : Se connecter

1. Ouvrir : **https://cloud.appwrite.io/console**
2. Se connecter avec votre compte
3. S√©lectionner le projet : **EcosystIA** (`68e54e9c002cb568cfec`)
4. Aller dans **Databases**
5. S√©lectionner la base de donn√©es : **EcosystIA** (`68e56de100267007af6a`)

---

## üì¶ COLLECTION 1 : BUDGETS

### Informations de base

- **ID de la collection** : `demo_budgets`
- **Nom** : `Demo Budgets`

### Attributs √† cr√©er

| Nom | Type | Taille | Requis | Par d√©faut | Description |
|-----|------|--------|--------|------------|-------------|
| `title` | String | 255 | ‚úÖ Oui | - | Nom du budget |
| `type` | String | 50 | ‚úÖ Oui | - | "Project" ou "Office" |
| `amount` | Float | - | ‚úÖ Oui | - | Montant total allou√© |
| `spent` | Float | - | ‚ùå Non | 0 | Montant d√©pens√© |
| `remaining` | Float | - | ‚ùå Non | - | Montant restant |
| `projectId` | String | 50 | ‚ùå Non | - | ID du projet (si type=Project) |
| `startDate` | String | 50 | ‚úÖ Oui | - | Date de d√©but (ISO 8601) |
| `endDate` | String | 50 | ‚úÖ Oui | - | Date de fin (ISO 8601) |
| `createdBy` | String | 50 | ‚úÖ Oui | - | ID de l'utilisateur cr√©ateur |
| `createdAt` | String | 50 | ‚ùå Non | - | Date de cr√©ation |
| `updatedAt` | String | 50 | ‚ùå Non | - | Date de mise √† jour |

### Permissions

**Create** : 
- Role: `users` (tous les utilisateurs authentifi√©s)

**Read** :
- Role: `users`

**Update** :
- Role: `users`

**Delete** :
- Role: `users`

### Index (optionnel mais recommand√©)

1. **Index par type**
   - Nom : `type_index`
   - Type : Key
   - Attributs : `type` (ASC)

2. **Index par projet**
   - Nom : `project_index`
   - Type : Key
   - Attributs : `projectId` (ASC)

---

## üì¶ COLLECTION 2 : BUDGET LINES (Lignes de budget)

### Informations de base

- **ID de la collection** : `demo_budget_lines`
- **Nom** : `Demo Budget Lines`

### Attributs √† cr√©er

| Nom | Type | Taille | Requis | Par d√©faut | Description |
|-----|------|--------|--------|------------|-------------|
| `budgetId` | String | 50 | ‚úÖ Oui | - | ID du budget parent |
| `name` | String | 255 | ‚úÖ Oui | - | Nom de la ligne budg√©taire |
| `category` | String | 100 | ‚úÖ Oui | - | Cat√©gorie (ex: "Personnel", "Marketing") |
| `amount` | Float | - | ‚úÖ Oui | - | Montant allou√© |
| `spent` | Float | - | ‚ùå Non | 0 | Montant d√©pens√© |
| `remaining` | Float | - | ‚ùå Non | - | Montant restant |
| `description` | String | 1000 | ‚ùå Non | - | Description d√©taill√©e |
| `createdAt` | String | 50 | ‚ùå Non | - | Date de cr√©ation |
| `updatedAt` | String | 50 | ‚ùå Non | - | Date de mise √† jour |

### Permissions

**Create/Read/Update/Delete** : 
- Role: `users`

### Index

1. **Index par budget**
   - Nom : `budget_index`
   - Type : Key
   - Attributs : `budgetId` (ASC)

---

## üì¶ COLLECTION 3 : BUDGET ITEMS (Items de budget)

### Informations de base

- **ID de la collection** : `demo_budget_items`
- **Nom** : `Demo Budget Items`

### Attributs √† cr√©er

| Nom | Type | Taille | Requis | Par d√©faut | Description |
|-----|------|--------|--------|------------|-------------|
| `budgetLineId` | String | 50 | ‚úÖ Oui | - | ID de la ligne budg√©taire |
| `description` | String | 500 | ‚úÖ Oui | - | Description de l'item |
| `amount` | Float | - | ‚úÖ Oui | - | Montant de l'item |
| `date` | String | 50 | ‚úÖ Oui | - | Date de la d√©pense |
| `reference` | String | 100 | ‚ùå Non | - | R√©f√©rence (facture, bon de commande) |
| `status` | String | 50 | ‚ùå Non | "pending" | Statut (pending, approved, rejected) |
| `createdBy` | String | 50 | ‚ùå Non | - | ID de l'utilisateur |
| `createdAt` | String | 50 | ‚ùå Non | - | Date de cr√©ation |

### Permissions

**Create/Read/Update/Delete** : 
- Role: `users`

### Index

1. **Index par ligne budg√©taire**
   - Nom : `budget_line_index`
   - Type : Key
   - Attributs : `budgetLineId` (ASC)

---

## üì¶ COLLECTION 4 : RECURRING INVOICES (Factures r√©currentes)

### Informations de base

- **ID de la collection** : `demo_recurring_invoices`
- **Nom** : `Demo Recurring Invoices`

### Attributs √† cr√©er

| Nom | Type | Taille | Requis | Par d√©faut | Description |
|-----|------|--------|--------|------------|-------------|
| `frequency` | String | 50 | ‚úÖ Oui | - | Fr√©quence (monthly, quarterly, yearly) |
| `clientName` | String | 255 | ‚úÖ Oui | - | Nom du client |
| `clientEmail` | String | 255 | ‚ùå Non | - | Email du client |
| `amount` | Float | - | ‚úÖ Oui | - | Montant de la facture |
| `description` | String | 1000 | ‚ùå Non | - | Description |
| `nextDate` | String | 50 | ‚úÖ Oui | - | Prochaine date de facturation |
| `lastDate` | String | 50 | ‚ùå Non | - | Derni√®re date de facturation |
| `status` | String | 50 | ‚ùå Non | "active" | Statut (active, paused, cancelled) |
| `createdBy` | String | 50 | ‚úÖ Oui | - | ID de l'utilisateur cr√©ateur |
| `createdAt` | String | 50 | ‚ùå Non | - | Date de cr√©ation |
| `updatedAt` | String | 50 | ‚ùå Non | - | Date de mise √† jour |

### Permissions

**Create/Read/Update/Delete** : 
- Role: `users`

### Index

1. **Index par statut**
   - Nom : `status_index`
   - Type : Key
   - Attributs : `status` (ASC)

2. **Index par prochaine date**
   - Nom : `next_date_index`
   - Type : Key
   - Attributs : `nextDate` (ASC)

---

## üì¶ COLLECTION 5 : RECURRING EXPENSES (D√©penses r√©currentes)

### Informations de base

- **ID de la collection** : `demo_recurring_expenses`
- **Nom** : `Demo Recurring Expenses`

### Attributs √† cr√©er

| Nom | Type | Taille | Requis | Par d√©faut | Description |
|-----|------|--------|--------|------------|-------------|
| `frequency` | String | 50 | ‚úÖ Oui | - | Fr√©quence (monthly, quarterly, yearly) |
| `category` | String | 100 | ‚úÖ Oui | - | Cat√©gorie de d√©pense |
| `amount` | Float | - | ‚úÖ Oui | - | Montant de la d√©pense |
| `description` | String | 1000 | ‚úÖ Oui | - | Description |
| `vendor` | String | 255 | ‚ùå Non | - | Fournisseur |
| `nextDate` | String | 50 | ‚úÖ Oui | - | Prochaine date de paiement |
| `lastDate` | String | 50 | ‚ùå Non | - | Derni√®re date de paiement |
| `status` | String | 50 | ‚ùå Non | "active" | Statut (active, paused, cancelled) |
| `createdBy` | String | 50 | ‚úÖ Oui | - | ID de l'utilisateur cr√©ateur |
| `createdAt` | String | 50 | ‚ùå Non | - | Date de cr√©ation |
| `updatedAt` | String | 50 | ‚ùå Non | - | Date de mise √† jour |

### Permissions

**Create/Read/Update/Delete** : 
- Role: `users`

### Index

1. **Index par cat√©gorie**
   - Nom : `category_index`
   - Type : Key
   - Attributs : `category` (ASC)

2. **Index par statut**
   - Nom : `status_index`
   - Type : Key
   - Attributs : `status` (ASC)

---

## üìù PROC√âDURE PAS √Ä PAS

### Pour chaque collection :

1. **Cr√©er la collection**
   - Dans Appwrite Console ‚Üí Databases ‚Üí Votre base de donn√©es
   - Cliquer sur **"Create Collection"**
   - Entrer l'**ID** (ex: `demo_budgets`)
   - Entrer le **Nom** (ex: `Demo Budgets`)
   - Cliquer sur **"Create"**

2. **Ajouter les attributs**
   - Dans la collection cr√©√©e, aller dans l'onglet **"Attributes"**
   - Cliquer sur **"Create Attribute"**
   - Pour chaque attribut :
     - S√©lectionner le **Type** (String, Float, etc.)
     - Entrer le **Key** (nom de l'attribut)
     - D√©finir la **Size** (pour les String)
     - Cocher **"Required"** si n√©cessaire
     - D√©finir **"Default Value"** si n√©cessaire
     - Cliquer sur **"Create"**

3. **Configurer les permissions**
   - Aller dans l'onglet **"Settings"**
   - Scroller jusqu'√† **"Permissions"**
   - Cliquer sur **"Update Permissions"**
   - Pour chaque permission (Create, Read, Update, Delete) :
     - Cliquer sur **"Add a role"**
     - S√©lectionner **"Any"** ‚Üí **"Users"** (tous les utilisateurs authentifi√©s)
     - Cliquer sur **"Add"**
   - Cliquer sur **"Update"**

4. **Cr√©er les index (optionnel)**
   - Aller dans l'onglet **"Indexes"**
   - Cliquer sur **"Create Index"**
   - Suivre les sp√©cifications ci-dessus

---

## ‚úÖ CHECKLIST DE VALIDATION

### Apr√®s cr√©ation de toutes les collections

- [ ] 5 collections cr√©√©es dans Appwrite
- [ ] Tous les attributs ajout√©s pour chaque collection
- [ ] Permissions configur√©es (users : Create, Read, Update, Delete)
- [ ] Index cr√©√©s (recommand√©)
- [ ] Tester avec l'application

### Test rapide

```typescript
// Tester dans la console du navigateur (apr√®s connexion)
import { budgetService } from './services/financeService';

const testBudget = await budgetService.create({
  title: "Test Budget",
  type: "Office",
  amount: 10000,
  startDate: "2025-10-01",
  endDate: "2025-12-31"
}, "user_id_test");

console.log('‚úÖ Budget cr√©√©:', testBudget);
```

---

## üéØ ORDRE DE CR√âATION RECOMMAND√â

1. **En premier** : `demo_budgets` (prioritaire)
2. **Ensuite** : `demo_budget_lines`
3. **Puis** : `demo_budget_items`
4. **Ensuite** : `demo_recurring_invoices`
5. **Enfin** : `demo_recurring_expenses`

---

## üÜò PROBL√àMES COURANTS

### Probl√®me 1 : Erreur "Invalid collection ID"

**Cause** : ID contient des caract√®res interdits  
**Solution** : Utiliser uniquement `a-z`, `A-Z`, `0-9`, `_` (underscore)

### Probl√®me 2 : Erreur "Attribute already exists"

**Cause** : Attribut d√©j√† cr√©√©  
**Solution** : V√©rifier la liste des attributs existants

### Probl√®me 3 : Permissions non appliqu√©es

**Cause** : Permissions non sauvegard√©es  
**Solution** : V√©rifier que vous avez cliqu√© sur "Update" apr√®s ajout des r√¥les

---

## üìä R√âCAPITULATIF

### Collections Finance

| Collection | Attributs | Index | Utilisation |
|-----------|-----------|-------|-------------|
| `demo_budgets` | 11 | 2 | Budgets principaux |
| `demo_budget_lines` | 9 | 1 | Lignes budg√©taires |
| `demo_budget_items` | 8 | 1 | Items d√©taill√©s |
| `demo_recurring_invoices` | 11 | 2 | Factures auto |
| `demo_recurring_expenses` | 11 | 2 | D√©penses auto |
| **TOTAL** | **50 attributs** | **8 index** | **Module Finance complet** |

---

## üöÄ APR√àS CR√âATION

Une fois toutes les collections cr√©√©es :

1. ‚úÖ **V√©rifier** que les services fonctionnent :
   ```bash
   npm run dev
   ```

2. ‚úÖ **Tester** la cr√©ation d'un budget :
   - Ouvrir l'app
   - Aller dans Finance
   - Cr√©er un budget
   - Refresh (F5)
   - ‚úÖ Budget pr√©sent

3. ‚úÖ **D√©ployer** :
   ```bash
   npm run build
   npm run deploy
   ```

---

## üéâ F√âLICITATIONS !

Une fois ces 5 collections cr√©√©es, votre **module Finance sera 100% fonctionnel** avec :

- ‚úÖ Gestion des budgets compl√®te
- ‚úÖ Suivi d√©taill√© des d√©penses
- ‚úÖ Factures et d√©penses r√©currentes
- ‚úÖ Calculs automatiques
- ‚úÖ Persistance totale dans Appwrite

---

**Date** : 13 octobre 2025  
**Statut** : üìã **GUIDE PR√äT - √Ä EX√âCUTER**  
**Dur√©e estim√©e** : 15-20 minutes  
**Difficult√©** : ‚≠ê‚≠ê (Moyenne)

